Qiitaの記事の通り移植したが，うまく動いていない
