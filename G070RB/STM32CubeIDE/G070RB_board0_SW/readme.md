# 目的

128x32 SSD1306 OLED 使用
AIN0 = PA0 をなるべく速く読むテスト

# 概要

- 6ビット限定 サンプリング時間も最小 1.5cycle
- Continuousモード
- DMAを使用する場合，ADが終わるのが速すぎてDMAが追いつかずフリーズしてしまう。どうしてもDMAを使う場合，サンプリング周期を大きく，ADCクロックプリスケーラーも大きくする。
- よって，普通に読む方が早いという結論。TIM16を100kで動かし，TIM16の割り込みハンドラの中でADCすることに成功している。
- サンプルとして TIM17 でPWMを作っている。PA7に出力されるので，PA0に接続して読む。

コネクター右側

```
     PC9 1  2
PB8 10 \
         3  4
PB9  9 \
         5  6
AVDD 8 \
         7  8
 GND 7 \
         9 10
 PA5 6 \
        11 12
 PA6 5 \
        13 14
 PA7 4 \
        15 16  ...

```


# 参考

http://dad8893.blogspot.com/2019/03/stm32-adcdmanucleo-f446re.html
http://matsubara-ui-design.net/2022/06/stm32_adc/

# メモ

サンプリングデータは 0 --- 0x111111 6ビット
ターゲットは 0 --- 15までの16個の値，4ビット まずは2ビット切り落とし。

0 ... 0x1111

# SW追加

上から見て PA10 PB3 PB5 の順番 CPU内プルアップ必要

メニューっぽい動作を作るところまでできた

RUNNINGのとき
PB3とPB5でサンプリング時間の切り替え
PA10 ... STOPする

STOPしているとき
PB3とPB5でトリガーモード切替
PA10 ... RUNに戻る


